{% extends "base.html" %}

{% block title %}Database Setup - VIGEO Health{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card mt-5">
                <div class="card-body p-4">
                    <h3 class="text-center mb-4">Database Setup</h3>
                    
                    <div class="alert alert-info">
                        <h5>Collection Structure:</h5>
                        <pre class="mb-0">
ğŸ“ VIGEOHealthCareersWebsite
  â”œâ”€â”€ ğŸ“„ config
  â”œâ”€â”€ ğŸ“‚ users/profiles
  â”œâ”€â”€ ğŸ“‚ jobPostings/active
  â””â”€â”€ ğŸ“‚ applications</pre>
                    </div>
                    
                    <div class="d-grid gap-2">
                        <button id="initBtn" class="btn btn-primary" onclick="initializeDB()">
                            Initialize Database Structure
                        </button>
                        
                        <button id="jobsBtn" class="btn btn-success" onclick="createSampleJobs()">
                            Create Sample Job Postings
                        </button>
                        
                        <a href="/careers" class="btn btn-outline-secondary">
                            Go to Careers Page
                        </a>
                    </div>
                    
                    <div id="result" class="mt-3"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function initializeDB() {
    document.getElementById('initBtn').disabled = true;
    document.getElementById('result').innerHTML = '<div class="alert alert-info">Initializing...</div>';
    
    fetch('/api/initialize', { method: 'POST' })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById('result').innerHTML = 
                    '<div class="alert alert-success">âœ… ' + data.message + '</div>';
            } else {
                document.getElementById('result').innerHTML = 
                    '<div class="alert alert-danger">âŒ Error: ' + data.error + '</div>';
            }
            document.getElementById('initBtn').disabled = false;
        })
        .catch(error => {
            document.getElementById('result').innerHTML = 
                '<div class="alert alert-danger">âŒ Error: ' + error + '</div>';
            document.getElementById('initBtn').disabled = false;
        });
}

function createSampleJobs() {
    document.getElementById('jobsBtn').disabled = true;
    document.getElementById('result').innerHTML = '<div class="alert alert-info">Creating jobs...</div>';
    
    fetch('/api/create-sample-jobs', { method: 'POST' })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById('result').innerHTML = 
                    '<div class="alert alert-success">âœ… ' + data.message + '</div>';
            } else {
                document.getElementById('result').innerHTML = 
                    '<div class="alert alert-danger">âŒ Error: ' + data.error + '</div>';
            }
            document.getElementById('jobsBtn').disabled = false;
        })
        .catch(error => {
            document.getElementById('result').innerHTML = 
                '<div class="alert alert-danger">âŒ Error: ' + error + '</div>';
            document.getElementById('jobsBtn').disabled = false;
        });
}
</script>
{% endblock %}